<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Welcome to Synergist.Cloud | Region: eu-west-1</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="author" content="Balinder Walia - Synergist.cloud">
<meta name="generator" content="vi">
<meta name="keywords" content="Synergist cloud, cloud job bagging system, job costing system, Synergist, Balinder, Walia">
<meta name="description" content="nginx test page">
 <!-- Tell the browser to be responsive to screen width -->
 <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
 <!-- Bootstrap 3.3.6 -->
 <link rel="stylesheet" href="css/bootstrap.min.css">
 <!-- Font Awesome -->
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
 <!-- Ionicons -->
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
 <!-- Theme style -->
 <link rel="stylesheet" href="css/Admin.min.css">
   <link rel="stylesheet" href="css/basictable.css">
 <link rel="stylesheet" href="css/skins/_all-skins.min.css">
 </head>
<body class="hold-transition skin-blue sidebar-mini">
 <div class="wrapper">
 

  <header class="main-header">
    <!-- Logo -->
    <a href="index.html" class="logo">
      <!-- mini logo for sidebar mini 50x50 pixels -->
       <span class="logo-mini"> <i class="fa fa-dot-circle-o"></i> </span>
      <!-- logo for regular state and mobile devices -->
     <span class="logo-lg"><i class="fa fa-dot-circle-o"></i> WebRouter</span>
    </a>
    <!-- Header Navbar: style can be found in header.less -->
    <nav class="navbar navbar-static-top">
      <!-- Sidebar toggle button-->
      <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
        <span class="sr-only">Toggle navigation</span>
      </a>

      <div class="navbar-custom-menu">
        <ul class="nav navbar-nav">
          <!-- Messages: style can be found in dropdown.less-->
          <li class="dropdown messages-menu">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              <i class="fa fa-envelope-o"></i>
              <span class="label label-success">4</span>
            </a>
            <ul class="dropdown-menu">
              <li class="header">You have 4 messages</li>
              <li>
                <!-- inner menu: contains the actual data -->
                <ul class="menu">
                  <li><!-- start message -->
                    <a href="#">
                      <div class="pull-left">
                        <img src="img/user2-160x160.jpg" class="img-circle" alt="User Image">
                      </div>
                      <h4>
                        Support Team
                        <small><i class="fa fa-clock-o"></i> 5 mins</small>
                      </h4>
                      <p>Why not buy a new awesome theme?</p>
                    </a>
                  </li>
                  <!-- end message -->
                  <li>
                    <a href="#">
                      <div class="pull-left">
                        <img src="img/user3-128x128.jpg" class="img-circle" alt="User Image">
                      </div>
                      <h4>
                        Design Team
                        <small><i class="fa fa-clock-o"></i> 2 hours</small>
                      </h4>
                      <p>Why not buy a new awesome theme?</p>
                    </a>
                  </li>
                  <li>
                    <a href="#">
                      <div class="pull-left">
                        <img src="img/user4-128x128.jpg" class="img-circle" alt="User Image">
                      </div>
                      <h4>
                        Developers
                        <small><i class="fa fa-clock-o"></i> Today</small>
                      </h4>
                      <p>Why not buy a new awesome theme?</p>
                    </a>
                  </li>
                  <li>
                    <a href="#">
                      <div class="pull-left">
                        <img src="img/user3-128x128.jpg" class="img-circle" alt="User Image">
                      </div>
                      <h4>
                        Sales Department
                        <small><i class="fa fa-clock-o"></i> Yesterday</small>
                      </h4>
                      <p>Why not buy a new awesome theme?</p>
                    </a>
                  </li>
                  <li>
                    <a href="#">
                      <div class="pull-left">
                        <img src="img/user4-128x128.jpg" class="img-circle" alt="User Image">
                      </div>
                      <h4>
                        Reviewers
                        <small><i class="fa fa-clock-o"></i> 2 days</small>
                      </h4>
                      <p>Why not buy a new awesome theme?</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="footer"><a href="#">See All Messages</a></li>
            </ul>
          </li>
          <!-- Notifications: style can be found in dropdown.less -->
          <li class="dropdown notifications-menu">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              <i class="fa fa-bell-o"></i>
              <span class="label label-warning">10</span>
            </a>
            <ul class="dropdown-menu">
              <li class="header">You have 10 notifications</li>
              <li>
                <!-- inner menu: contains the actual data -->
                <ul class="menu">
                  <li>
                    <a href="#">
                      <i class="fa fa-users text-aqua"></i> 5 new members joined today
                    </a>
                  </li>
                  <li>
                    <a href="#">
                      <i class="fa fa-warning text-yellow"></i> Very long description here that may not fit into the
                      page and may cause design problems
                    </a>
                  </li>
                  <li>
                    <a href="#">
                      <i class="fa fa-users text-red"></i> 5 new members joined
                    </a>
                  </li>
                  <li>
                    <a href="#">
                      <i class="fa fa-shopping-cart text-green"></i> 25 sales made
                    </a>
                  </li>
                  <li>
                    <a href="#">
                      <i class="fa fa-user text-red"></i> You changed your username
                    </a>
                  </li>
                </ul>
              </li>
              <li class="footer"><a href="#">View all</a></li>
            </ul>
          </li>
          <!-- Tasks: style can be found in dropdown.less -->
          <li class="dropdown tasks-menu">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              <i class="fa fa-file-o"></i>
              <span class="label label-danger">5</span>
            </a>
            <ul class="dropdown-menu">
              <li class="header">Switch Site to</li>
	        
	         <li STYLE="padding:15px;" >
                  
                      <input TYPE="text" CLASS="form-control"  STYLE="height:34px; border-radius:4px; border: 1px solid #ddd;">
                    
                   
                  </li>
              <li>
                <!-- inner menu: contains the actual data -->
                <ul class="menu">
                 
                  
                  <li>
                    <a href="#">
                      
                      Demo website
                    </a>
                  </li>
		    
		    
		    <li>
                    <a href="#">
                      
                      Demo website
                    </a>
                  </li>
		      
		      
		      
		      <li>
                    <a href="#">
                      
                      Demo website
                    </a>
                  </li>
		        
		        
		        
		        <li>
                    <a href="#">
                      
                      Demo website
                    </a>
                  </li>
			  
			  
			  
			  <li>
                    <a href="#">
                      
                      Demo website
                    </a>
                  </li>
			    
			    
			    
			    
			    <li>
                    <a href="#">
                      
                      Demo website
                    </a>
                  </li>
			      <li>
                    <a href="#">
                      
                     Testing website
                    </a>
                  </li>
			        
			        <li>
                    <a href="#">
                      
                     Live website
                    </a>
                  </li>
                 
               
                </ul>
              </li>
              
            </ul>
          </li>
          <!-- User Account: style can be found in dropdown.less -->
          <li class="dropdown user user-menu">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              <img src="img/user2-160x160.jpg" class="user-image" alt="User Image">
              <span class="hidden-xs">Alexander Pierce</span>
            </a>
            <ul class="dropdown-menu">
              <!-- User image -->
              <li class="user-header">
                <img src="img/user2-160x160.jpg" class="img-circle" alt="User Image">

                <p>
                  Alexander Pierce - Web Developer
                  <small>Member since Nov. 2012</small>
                </p>
              </li>
              <!-- Menu Body -->
              <li class="user-body">
                <div class="row">
                  <div class="col-xs-4 text-center">
                    <a href="#">Followers</a>
                  </div>
                  <div class="col-xs-4 text-center">
                    <a href="#">Sales</a>
                  </div>
                  <div class="col-xs-4 text-center">
                    <a href="#">Friends</a>
                  </div>
                </div>
                <!-- /.row -->
              </li>
              <!-- Menu Footer-->
              <li class="user-footer">
                <div class="pull-left">
                  <a href="#" class="btn btn-default btn-flat">Profile</a>
                </div>
                <div class="pull-right">
                  <a href="#" class="btn btn-default btn-flat">Sign out</a>
                </div>
              </li>
            </ul>
          </li>
          <!-- Control Sidebar Toggle Button -->
                </ul>
      </div>
    </nav>
  </header>
  <!-- Left side column. contains the logo and sidebar -->
  <aside class="main-sidebar">
    <!-- sidebar: style can be found in sidebar.less -->
    <section class="sidebar">
      <!-- Sidebar user panel -->
      <div class="user-panel">
        <div class="pull-left image">
          <img src="img/user2-160x160.jpg" class="img-circle" alt="User Image">
        </div>
        <div class="pull-left info">
          <p>Alexander Pierce</p>
          <a href="#"><i class="fa fa-circle text-success"></i> Online</a>
        </div>
      </div>
      <!-- search form -->
      <form action="#" method="get" class="sidebar-form">
        <div class="input-group">
          <input type="text" name="q" class="form-control" placeholder="Search...">
              <span class="input-group-btn">
                <button type="submit" name="search" id="search-btn" class="btn btn-flat" STYLE="border-left:none;     line-height: 12px;"><i class="fa fa-search"></i>
                </button>
              </span>
        </div>
      </form>
      <!-- /.search form -->
      <!-- sidebar menu: : style can be found in sidebar.less -->
      <ul class="sidebar-menu" id="main_menu_ui"">
      
        <li class="active treeview">
          <a href="index.html">
            <i class="fa fa-dashboard"></i> <span>Dashboard</span>
            <span class="pull-right-container">
              <i class="fa fa-angle-left pull-right"></i>
            </span>
          </a>
		  </li>
		  <li class=" treeview">
          <a href="#">
            <i class=" fa fa-list"></i> <span>Lists</span>
            <span class="pull-right-container">
              <i class="fa fa-angle-left pull-right"></i>
            </span>
          </a>
          <ul class="treeview-menu">
            <li class="active"><a href="lists.html"><i class="fa fa-circle-o"></i> Lists</a></li>
           	<li class="active"><a href="list.html"><i class="fa fa-circle-o"></i> Add New List</a></li>
          </ul>
        </li>
         <li class=" treeview">
          <a href="#">
            <i class=" fa fa-server"></i> <span>Hosts</span>
            <span class="pull-right-container">
              <i class="fa fa-angle-left pull-right"></i>
            </span>
          </a>
          <ul class="treeview-menu">
            <li class="active"><a href="hosts.html"><i class="fa fa-circle-o"></i> List Hosts</a></li>
           	<li class="active"><a href="host.html"><i class="fa fa-circle-o"></i> Add New Host</a></li>
          </ul>
        </li>
        <li class=" treeview">
          <a href="#">
            <i class="fa fa-life-ring"></i> <span>Rules</span>
            <span class="pull-right-container">
              <i class="fa fa-angle-left pull-right"></i>
            </span>
          </a>
          <ul class="treeview-menu">
            <li class="active"><a href="rules.html"><i class="fa fa-circle-o"></i> List Rules</a></li>
           	<li class="active"><a href="rule.html"><i class="fa fa-circle-o"></i> Add New Rule</a></li>
          </ul>
        </li>
        <li class=" treeview">
          <a href="#">
            <i class="fa fa-globe"></i> <span>Sites</span>
            <span class="pull-right-container">
              <i class="fa fa-angle-left pull-right"></i>
            </span>
          </a>
          <ul class="treeview-menu">
            <li class="active"><a href="sites.html"><i class="fa fa-circle-o"></i> List Sites</a></li>
           	<li class="active"><a href="site.html"><i class="fa fa-circle-o"></i> Add New Site</a></li>
          </ul>
        </li>
        <li class=" treeview">
          <a href="#">
            <i class=" fa fa-arrow-circle-o-up"></i> <span>Upstreams</span>
            <span class="pull-right-container">
              <i class="fa fa-angle-left pull-right"></i>
            </span>
          </a>
          <ul class="treeview-menu">
            <li class="active"><a href="upstreams.html"><i class="fa fa-circle-o"></i> List Upstreams </a></li>
           	<li class="active"><a href="upstream.html"><i class="fa fa-circle-o"></i> Add New Upstream</a></li>
          </ul>
        </li>
        <li class=" treeview">
          <a href="#">
            <i class="fa fa-globe"></i> <span>Urls</span>
            <span class="pull-right-container">
              <i class="fa fa-angle-left pull-right"></i>
            </span>
          </a>
          <ul class="treeview-menu">
            <li class="active"><a href="urls.html"><i class="fa fa-circle-o"></i> List Urls </a></li>
           	<li class="active"><a href="url_form.html"><i class="fa fa-circle-o"></i> Add New Url</a></li>
          </ul>
        </li>
		</ul>
    </section>
    <!-- /.sidebar -->
  </aside>

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <h1>
        <span id="pageHeadingID">Add</span>
        <small>Rule</small>
      </h1>
      <ol class="breadcrumb">
        <li><a href="index.html"><i class="fa fa-dashboard"></i> Home</a></li>
        <li class="active">Rule</li>
      </ol>
    </section>

    <!-- Main content -->
    <section class="content">
       
      <form class="form-horizontal" id="EntryForm">
	 <div class="row">
             <div class=" col-sm-12 col-lg-12">
               <input type="hidden" class="form-control" name="uuid" id="uuid"/>
	<div class="form-group">
    	<label for="" class="col-sm-2 control-label">Type<sup class="required">*</sup></label>
    	<div class="col-sm-5 ">
       		<select class="form-control required" id="rule_type" name="rule_type"></select>
    	</div>
    </div>
  <div class="form-group" id="condition_ui">
    <label for="" class="col-sm-2 control-label">Location/condition<sup class="required">*</sup></label>
    <div class="col-sm-5 ">
       <input class="form-control required" id="location" placeholder="Location" name="location" type="text">
    </div>
  </div>
	<div class="form-group rule_defined_ui static_content" style="display:none;">
    	<label for="" class="col-sm-2 control-label">Static Content</label>
    	<div class="col-sm-5 ">
       		<select class="form-control" id="static_content" name="static_content"></select>
    	</div>
    </div>
  <div class="form-group rule_defined_ui static_content" style="display:none;">
    <label for="" class="col-sm-2 control-label">Root Path</label>
    <div class="col-sm-6 ">
       <input class="form-control" id="root_path" name="root_path" type="text">
    </div>
  </div>

	<div class="form-group rule_defined_ui rewrite" style="display:none;">
    <label for="" class="col-sm-2 control-label">Regular Expression (reg-ex)</label>
    <div class="col-sm-6 ">
       <input class="form-control" id="rewrite_regex" name="rewrite_regex" type="text">
    </div>
  </div>
  <div class="form-group rule_defined_ui rewrite" style="display:none;">
    <label for="" class="col-sm-2 control-label">Replacement String</label>
    <div class="col-sm-6 ">
       <input class="form-control" id="rewrite_replacement_str" name="rewrite_replacement_str" type="text">
       <span STYLE="font-size:12px; color:#737373;">If the reqeust URI matches the reg-ex, then Nginx will use this replacement string to change the request URI accordingly</span>
    </div>
  </div>
  <div class="form-group rule_defined_ui rewrite" style="display:none;">
    <label for="" class="col-sm-2 control-label">Flag</label>
    <div class="col-sm-6 ">
       <select class="form-control" id="rewrite_flag" name="rewrite_flag">
       	<option value="">--Select--</option>
       	<option value="last">Last</option>
       	<option value="break">Stop Processing</option>
       	<option value="redirect">Temporary Redirect</option>
       	<option value="permanent">Permanently Redirect</option>
       </select>
    </div>
  </div>
	<div class="form-group rule_defined_ui proxy_pass" style="display:none;">
    	<label for="" class="col-sm-2 control-label">Proxy Pass</label>
    	<div class="col-sm-4">
       		<input class="form-control" id="proxy_pass" name="proxy_pass" type="text">
    	</div>
    	<label for="" class="col-sm-1 control-label" style="width:2px;">Or</label>
    	<label for="" class="col-sm-1 control-label">Upstream</label>
    	<div class="col-sm-4">
    		<select class="form-control" id="upstreams" name="upstreams"></select>
    	</div>
  	</div>
	<div class="form-group rule_defined_ui proxy_pass static_content" style="display:none;">
		<label for="" class="col-sm-2 control-label"></label>
    	<div class="col-sm-3">
       		<label><input id="enable_cache" name="enable_cache" type="checkbox" value="1"> Enable Cache</label>
    	</div>
    	<div class="col-sm-6 ">
       		<label><input id="proxy_set_header" name="proxy_set_header" type="checkbox" value="1"> Set Proxy Header</label>
    	</div>
  	</div>
	<div class="form-group rule_defined_ui fastcgi_proxy" style="display:none;">
    	<label for="" class="col-sm-2 control-label">FastCGI Index</label>
    	<div class="col-sm-6 ">
       		<input class="form-control" id="fastcgi_index" name="fastcgi_index" type="text">
    	</div>
  	</div>
  	<div class="form-group rule_defined_ui fastcgi_proxy" style="display:none;">
    	<label for="" class="col-sm-2 control-label">FastCGI Pass</label>
    	<div class="col-sm-6 ">
       		<input class="form-control" id="fastcgi_pass" name="fastcgi_pass" type="text">
    	</div>
  	</div>
  	<div class="form-group rule_defined_ui fastcgi_proxy" style="display:none;">
    	<label for="" class="col-sm-2 control-label">Set Parameters for FastCGI</label>
    	<div class="col-sm-6 ">
       		<input class="form-control" id="fastcgi_param" name="fastcgi_param" type="text">
    	</div>
  	</div>
  	
  	<div class="col-sm-12 margin-top-15 " align="CENTER">
		<input class="btn btn-primary btn-color margin-right-5 btn-sm " value="Submit" type="submit">  
	</div>
</div>
	      
             
	      </div>
             
             </form>
   </section>
          <!-- right col -->
      </div>
      <!-- /.row (main row) -->

	<footer class="main-footer">
	    <strong>Copyright &copy; 2016-2017 <a href="http://www.synergist.co.uk" target="_blank">Synergist</a>.</strong> All rights reserved.
  	</footer>
</div>
<script src="js/jquery-2.2.3.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/jquery.validate.js"></script>
<script type="text/javascript">
var rule_type_selected='', selected_upstreams=_val='';
	function fetch_list_details(fetch_list, display_id){
		$.getJSON("/api_get_key?key=list:"+fetch_list,function(result){
			if(result.success && result.aaData && result.aaData.length>0){
				var aaDataStr= result.aaData;
				var aaDataObj = JSON.parse(aaDataStr);
				$.each(aaDataObj, function(key,value){
					if(key=="list_details"){
						var contentStr='';
						var subDataObj = JSON.parse(value);
						$.each(subDataObj, function(i,row){
							contentStr+='<option value="'+row.value+'">'+row.label+'</option>';
						});
						if(contentStr!=""){
							$("#"+display_id).html('<option value="">--Select--</option>'+contentStr);
						}else{
							$("#"+display_id).after('<span style="color:red;font-style:italic;">Please define list with code : "'+fetch_list+'"</span>');
						}
					}
				});
			}else{
				$("#"+display_id).after('<span style="color:red;font-style:italic;">Please define list with code : "'+fetch_list+'"</span>');
			}
		});
	}
$(document).ready(function() {
		// fetch upstreams
		$.getJSON("/api_fetch_list?search=upstream",function(result){
			if(result.aaData && result.aaData.length>0){
				var contentStr='';
				$.each(result.aaData, function(i,row){
					contentStr+='<option value="'+row.key+'">'+row.key+'</option>';
				});
				if(contentStr!=""){
					$("#upstreams").html('<option value="">--Select--</option>'+contentStr);
				}else{
					$("#upstreams").after('<a href="upstream.html" class="btn btn-info" target="_blank" style="margin-top:5px;">Add new upstream</span>');
				}
			}else{
				$("#upstreams").after('<a href="upstream.html" class="btn btn-info" target="_blank" style="margin-top:5px;">Add new upstream</span>');
			}
		});
				
	$("#upstreams").change(function(){
		var tempValue = $(this).val();
		if(tempValue=="" && tempValue==null && selected_upstreams!=""){
			tempValue = selected_upstreams;
		}
		if(tempValue!="" && tempValue!==null){
			tempValue=tempValue.replace('upstream:', '')
			$("#proxy_pass").val("http://"+tempValue);
		}
	});
	
	$("#rule_type").change(function(){
		$("#condition_ui").show();
		$(".rule_defined_ui").hide();
		var s_val= $(this).val();
		if(s_val=="" && s_val==null && rule_type_selected!=""){
			s_val = rule_type_selected;
		}	
		if(s_val!=""){
			$("."+s_val).show();
		}
		if(s_val=="static_content"){
			$("#condition_ui").hide();
			fetch_list_details("static-content", "static_content");
		}
		if(s_val=="rewrite"){
			// fetch rewrite flags
			fetch_list_details("rewrite-flag", "rewrite_flag");
		}
	});
	
		// fetch rules type
		fetch_list_details("rule-type", "rule_type");
		
	if(getUrlVars() && getUrlVars()["id"]  && getUrlVars()["id"]!="") {
		$.getJSON("/api_get_key?key="+getUrlVars()["id"],function(result){
			if(result.success && result.aaData && result.aaData.length>0){
				$("#pageHeadingID").html("Edit");
				var aaDataStr= result.aaData;
				var aaDataObj = JSON.parse(aaDataStr);
				$.each(aaDataObj, function(key,value){
					$("#"+key).val(value);
					if(key=="rule_type"){
						rule_type_selected = value;
						$("#rule_type").trigger("change");
					}
					if(key=="upstreams"){
						selected_upstreams =  value;
						$("#upstreams").trigger("change");
					}
					if(key=="enable_cache"){
						$("#enable_cache").prop("checked", true);
					}
					if(key=="proxy_set_header"){
						$("#proxy_set_header").prop("checked", true);
					}
				});
			}
		});
	}
	
    $("#EntryForm").validate({
		ignore: "",
		onkeyup: false,
		errorClass: 'error',
		validClass: 'valid',
		errorElement: "em",
		errorPlacement: function(error, element) {
			$(element).closest('div').append(error);
		},
		onfocusout: false,
		invalidHandler: function(form, validator) {
			var errors = validator.numberOfInvalids();
			if (errors) {                    
				validator.errorList[0].element.focus();
			}
		},
		rules: {
			rule_type: { required: true },
			location : { required: true }
		},
		submitHandler: function(form) {
			var tokenStr=$("#uuid").val();
			if(tokenStr=="") {
				var tokenStr=guid();
				$("#uuid").val(tokenStr);
			}
			var entry_form_data_obj = dataAsJson("EntryForm");
			var keyStr= "rule:"+tokenStr;
			$.ajax({
				url: '/api_post_key',
				type: 'POST',
				data: { "key" : keyStr, "value" : JSON.stringify(entry_form_data_obj) },
				contentType: false,
				dataType: 'json',
				success: function(response){
					if(response.success){
						window.location.href = "rule.html?id=rule:"+tokenStr+"&"+Math.random();
					} else if(response.error) {
						$('#EntryForm').before('<div class="alert alert-error alert-dismissable uploadFile"><button aria-hidden="true" data-dismiss="alert" class="close" type="button">×</button>'+response.error+'</div>');
					}else {
						$('#EntryForm').before('<div class="alert alert-error alert-dismissable uploadFile"><button aria-hidden="true" data-dismiss="alert" class="close" type="button">×</button>Sorry, error while saving details!</div>');
					}
				}
			});
		}
	});

});
</script>
<script src="js/basictable.js"></script>
<script src="js/app.min.js"></script>
<script src="js/custom.js"></script>
</body>
</html>